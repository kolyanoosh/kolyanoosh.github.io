<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8">
  <title>cssanim</title>
 </head>
 <body id="body1">
  <button id="button1" class="btn123" onclick="window.location.href = 'index.html'">Home</button>
  <button id="button2" class="btn123" onclick="window.location.href = 'market.html'">Skins</button>
  <button id="button3" class="btn123" onclick="asmrbutton()">Turn on/off ASMR</button>
  <img id="imgmain" src="background.png"></div>
  <img id="cat" src="https://i.postimg.cc/mr4xCRq2/catforanim.png" />
  <img id="coin" class="coin" src="coin.png" />
  <div id="backgr"></div>
  <div id="fishing-rod"></div>
  <div class="line" id="line"></div>
  <h1 id="score" class="centr">0</h1>
  <h1 id="timer">-</h1>
  <h3 id="listtext">Listing близко,ближе,чем вы думаете</h3>
  <h2 id="name" style="position:absolute;left:10;top:0;margin-bottom:0;visibility:hidden">1</h2>
  
  <style>/* The animation code */
    /* The animation code */
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Exo:wght@400;700&display=swap');
    @keyframes example1 {
        0%   {height:50px;}
        50% {height:100px;}
        100% {height:50px;}
    }
    @keyframes animforcoin {
        0% {top: 485px;
            visibility: hidden;}
        50% {top: 485px;
            visibility: hidden;}
        100% {top: 435px;
            visibility: visible;}
    }

    /* The element to apply the animation to */
    .exampleanim{
        animation: example 4s forwards;
    }
    .exampleanim1{
        animation: example1 2s forwards;
    }
    .animforcoin1{
        animation: animforcoin 2s forwards;
    }
    html,body {
      width: 100%;
      overflow: hidden;
    }
    .centr{
        position: absolute;
        top: 160px;
        left: 150px;

    }
    #imgmain{
        z-index: -2;
    }
    .coin{
       position: fixed;
       left: 160px;
       top: 485px;
       visibility: hidden;
       z-index: 99999999;
    }
    #fishing-rod {
        position: relative;
        bottom: 772px;
        left: 155px;
        width: 3px;
        height: 100px;
        background-color: #8b4513;
        transform: rotate(35deg);
        z-index: 2;
    }
    #frame{
        position: absolute;
        left: 165px;
        bottom: 502px;
    }
    #timer{
        position: fixed;
        top: 100px;
        left: 85px;
    }
    #listtext{
        position: fixed;
        top: 50px;
    }
    .line {
        position: relative;
        left: 182px;
        transform: translateX(-50%);
        width: 2px;
        height: 50px;
        top: -850px;
        background-color: #000;
    }
    #cat{
        width: 400px;
        position:relative;
        left:-60px;
        right:100px;
        top: -500px;
    }
    #backgr{
        position: fixed;
        top: 580px;
        width: 365px;
        height: 60px;
        border-radius: 15px;
        z-index: 0;
        background-color: #5a5858;
    }
    
    #button1 {
            position: fixed;
            top: 600px;
            width: 100px;
            left: 10px;
            border-radius: 15px;
            z-index: 1;
            background-color: #333;
            color: aliceblue;
            font-family: 'Exo', sans-serif;
        }
    #button2 {
        position: fixed;
        top: 600px;
        width: 100px;
        left: 130px;
        border-radius: 15px;
        z-index: 1;
        background-color: #333;
        color: aliceblue;
        font-family: 'Exo', sans-serif;
    }
    #button3 {
        position: fixed;
        top: 590px;
        width: 100px;
        left: 250px;
        border-radius: 15px;
        z-index: 1;
        background-color: #333;
        color: aliceblue;
        font-family: 'Exo', sans-serif;
    }
    #button1:active { background: rgba(255,255,255,.2); }
    #button2:active { background: rgba(255,255,255,.2); }
    #button3:active { background: rgba(255,255,255,.2); }
    </style>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
        import { getFirestore,getDoc,getDocs, doc, collection, addDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyA3DHLEIODQIz1bVJeJQjBPzt2ws9AjeR0",
          authDomain: "cryptofish-2e064.firebaseapp.com",
          projectId: "cryptofish-2e064",
          storageBucket: "cryptofish-2e064.appspot.com",
          messagingSenderId: "17827617649",
          appId: "1:17827617649:web:033599b13d0de7e95634d0",
          measurementId: "G-47WE3X1NEG"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        console.log(app);

        const db = getFirestore();
     
        let tg = window.Telegram.WebApp;
        let username = tg.initDataUnsafe.user.username;
        let chatidtg = tg.initDataUnsafe.user.id;
        window.Telegram.WebApp.disableVerticalSwipes()
     
        getDoc(doc(db,'Users',username)).then(docSnap =>{
            if(docSnap.exists()){
                console.log(docSnap.data()['money'])
                getDoc(doc(db,'skins',docSnap.data()['skinnow'])).then(docSnap001 =>{
                    document.getElementById("cat").src = docSnap001.data().url;
                })
            }
            else{
                if(docSnap.exists()){
                    console.log(docSnap.data()['money'])
                    getDoc(doc(db,'skins',docSnap.data()['skinnow'])).then(docSnap001 =>{
                        document.getElementById("cat").src = docSnap001.data().url;
                    })
                }
                else{
                    setDoc(doc(db, "Users", username), {
                        money: 0,
                        skinnow: "cat",
                        skinshave: ["cat"],
                        chatid: chatidtg
                    });
                }
            }

        })
        

        /* Задайте желаемый идентификатор документа
        const documentId = 'neuralproguy';
        setDoc(doc(db, "Users", documentId), {
            money: 100000
        });*/

    
        let line = document.querySelector('.line');
        let btnstop = document.getElementById('paus');
        let h1 = document.getElementById('score');
        let coin = document.querySelector('.coin');
        getDoc(doc(db,'Users',username)).then(docSnap =>{
            if(docSnap.exists()){
                console.log(docSnap.data()['money'])
                h1.innerText = docSnap.data()['money'];
            }

        })
        let h2 = document.getElementById('name');

        console.log(parseInt(h1.innerText)+1)

        function randomInteger(min, max) {
            // случайное число от min до (max+1)
            let rand = min + Math.random() * (max + 1 - min);
            rand = Math.floor(rand);
            console.log(rand);
            return rand;
        }

        let bodyk = document.getElementById('body1');
        document.addEventListener("click", function() {
            line.classList.add('exampleanim1');
            coin.classList.add("animforcoin1")
            randomInteger(1,5);
        });

        // Отслеживаем окончание анимации
        line.addEventListener("animationend", AnimationHandler1, false);
        function AnimationHandler () {
            // Удаляем класс с анимацией
            box.classList.remove('exampleanim');
        }
        function AnimationHandler1 () {
            // Удаляем класс с анимацией
            line.classList.remove('exampleanim1');
            coin.classList.remove('animforcoin1');
            randomint = randomInteger(10,50);
            h1.innerText = parseInt(h1.innerText)+randomint;
            getDoc(doc(db,'Users',username)).then(docSnap01 =>{
                setDoc(doc(db, "Users", username), {
                   money : parseInt(h1.innerText),
                   skinshave: docSnap01.data()['skinshave'],
                   skinnow : docSnap01.data()['skinnow'],
                   chatid: chatidtg
                 });
            })
        }
        h2.innerText = username; 
    </script>
    <script>
        function randomInteger(min, max) {
            // случайное число от min до (max+1)
            let rand = min + Math.random() * (max + 1 - min);
            rand = Math.floor(rand);
            console.log(rand);
            return rand;
        }
        
        let h12 = document.getElementById('score');
        document.addEventListener("click", function() {
            console.log(1);
            randomint = randomInteger(10,50);
            h12.innerText = parseInt(h12.innerText)+randomint;
        });
        function asmrbutton(){
            const element = document.getElementById('asmr');
            if(element){
                document.getElementById("asmr").remove();
                console.log("yes!");
            }
            else{
                var iframe = document.createElement("iframe");
                
                iframe.setAttribute("id","asmr");
                iframe.setAttribute("width","210");
                iframe.setAttribute("height","157");
                iframe.setAttribute("src","https://www.youtube.com/embed/uCNiCPDlvkI");

                iframe.style.position = "relative";
                iframe.style.left = "158px";
                iframe.style.bottom = "1332px";

                document.body.appendChild(iframe);

            }
        }
        window.asmrbutton = asmrbutton;
        // Устанавливаем дату, до которой нужно создать таймер (год, месяц (от 0 до 11), день, часы, минуты, секунды)
    const targetDate = new Date('2024-09-01T23:59:59').getTime();

    // Обновляем таймер каждую секунду
    const timer = setInterval(function() {
    // Получаем текущую дату и время
    const now = new Date().getTime();

    // Вычисляем разницу между текущим временем и целевой датой
    const difference = targetDate - now;

    // Рассчитываем оставшееся время в днях, часах, минутах и секундах
    const days = Math.floor(difference / (1000 * 60 * 60 * 24));
    const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((difference % (1000 * 60)) / 1000);

    // Выводим оставшееся время в элемент с id="timer"
    console.log(`${days}:${hours}:${minutes}:${seconds}`);
    let timer = document.getElementById('timer');
    timer.textContent = `${days}:${hours}:${minutes}:${seconds}`;


    // Если время истекло, выводим сообщение и останавливаем таймер
    if (difference < 0) {
        clearInterval(timer);
        console.log('Время истекло!');
    }
}, 1000);
    </script>
 </body>
</html>

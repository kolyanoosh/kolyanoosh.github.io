<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>tasks</title>
    </head>
    <body style="background-color: #63abea;">
        <button id="btn" class="taskclass">Пригласи друга+10000</button>
        <style>
            .taskclass{
               background-color: #539edf;  
            }
            #btn{
                position: relative;
                top: 0px;
                left: 20px;
                height: 60px;
                width: 300px;
                background-image: url('coin.png');
                background-size: auto 100%;
                background-position: 50px 0;
                background-repeat:no-repeat;
                border-radius: 30px;
                font-weight: 700;
                font-size: 1.3rem;
            }
        </style>
        <script src="https://telegram.org/js/telegram-web-app.js"></script>
        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
            import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
            import { getFirestore,getDoc,getDocs, doc, collection, addDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
            // TODO: Add SDKs for Firebase products that you want to use
            // https://firebase.google.com/docs/web/setup#available-libraries
      
            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            const firebaseConfig = {
              apiKey: "AIzaSyA3DHLEIODQIz1bVJeJQjBPzt2ws9AjeR0",
              authDomain: "cryptofish-2e064.firebaseapp.com",
              projectId: "cryptofish-2e064",
              storageBucket: "cryptofish-2e064.appspot.com",
              messagingSenderId: "17827617649",
              appId: "1:17827617649:web:033599b13d0de7e95634d0",
              measurementId: "G-47WE3X1NEG"
            };
      
            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const analytics = getAnalytics(app);
            console.log(app);

            const db = getFirestore();
            btn = document.getElementById('btn');
            btn.addEventListener("click", function() {
                let tg = window.Telegram.WebApp;
                let username = tg.initDataUnsafe.user.username;
                getDoc(doc(db,'Users',username)).then(docSnap =>{
                    if(docSnap.exists()){
                        console.log(docSnap.data()['money'])
                        setDoc(doc(db, "Users", username), {
                            money: parseInt(docSnap.data()['money'])+10000
                        });
                    }
                    else(){
                        console.log();
                    }
                })
                window.onload = function() {
                    window.open('https://t.me/share/url?url=https://t.me/cryptofishcatch_bot', '_blank');
                }
            });
        </script>
        <script>
            btn = document.getElementById('btn');
            btn.addEventListener("click", function() {
                window.onload = function() {
                    window.open('https://t.me/share/url?url=https://t.me/cryptofishcatch_bot', '_blank');
                }
            });
        </script>
    </body>
</html>
